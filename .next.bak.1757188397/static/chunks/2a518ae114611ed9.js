(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,76439,o=>{"use strict";async function e(){if(!("Notification"in window))return console.warn("This browser does not support notifications"),"denied";if("granted"===Notification.permission)return"granted";if("denied"===Notification.permission)return"denied";let o=await Notification.requestPermission();return console.log("Notification permission:",o),o}async function i(o){try{let i=await e();if("granted"!==i)return console.warn("Notification permission not granted"),null;let n=await o.pushManager.getSubscription();if(n)return console.log("Already subscribed to push notifications"),n;let t=function(o){let e="=".repeat((4-o.length%4)%4),i=(o+e).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(i),r=new Uint8Array(n.length);for(let o=0;o<n.length;++o)r[o]=n.charCodeAt(o);return r}("BEffMaVuuKK12Yl5mulPU99ZShnk-0l_gbOuNVtidI0zOQsxJNQFQsP4vTfYHkUqTswmvOMfAscLZf5NkrPTgmk"),s=await o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t});return console.log("Successfully subscribed to push notifications:",s),await r(s),s}catch(o){return console.error("Failed to subscribe to push notifications:",o),null}}async function n(o){try{let e=await o.pushManager.getSubscription();if(!e)return console.log("No subscription found"),!0;let i=await e.unsubscribe();return i&&(console.log("Successfully unsubscribed from push notifications"),await t(e)),i}catch(o){return console.error("Failed to unsubscribe from push notifications:",o),!1}}async function r(o){try{(await fetch("/api/push/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:o,timestamp:Date.now()})})).ok||console.warn("Failed to save subscription to server")}catch(o){console.error("Error sending subscription to server:",o)}}async function t(o){try{(await fetch("/api/push/unsubscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:o})})).ok||console.warn("Failed to remove subscription from server")}catch(o){console.error("Error removing subscription from server:",o)}}async function s(o,e,i,n){if(!("Notification"in window)||"granted"!==Notification.permission)return;let r=new Notification("Analys komplett!",{body:"Din ".concat(e.toUpperCase(),"-analys av ").concat(i," Ã¤r klar. Score: ").concat(n),icon:"/icons/icon-192x192.png",badge:"/icons/icon-72x72.png",vibrate:[200,100,200],data:{jobId:o,analysisType:e,url:i,score:n},actions:[{action:"view",title:"Visa resultat"}],requireInteraction:!0,tag:"analysis-complete"});r.addEventListener("click",()=>{window.focus(),window.location.href="/analys/".concat(o),r.close()}),setTimeout(()=>{r.close()},1e4)}async function a(o){if(!("serviceWorker"in navigator)||!navigator.serviceWorker.controller)return console.warn("Service Worker not available for background sync"),null;try{let e=new MessageChannel;return new Promise((i,n)=>{e.port1.onmessage=o=>{o.data.success?i(o.data.analysisId):n(Error("Failed to queue analysis"))},navigator.serviceWorker.controller.postMessage({type:"QUEUE_ANALYSIS",analysisData:o,analysisId:Date.now().toString()},[e.port2])})}catch(o){return console.error("Error queuing analysis for background sync:",o),null}}async function c(){let o="Notification"in window&&"serviceWorker"in navigator&&"PushManager"in window;if(!o)return{supported:!1,permission:"denied",subscribed:!1};let e=Notification.permission,i=!1;try{let o=await navigator.serviceWorker.ready;i=!!await o.pushManager.getSubscription()}catch(o){console.error("Error checking subscription status:",o)}return{supported:o,permission:e,subscribed:i}}o.s(["getPushNotificationStatus",()=>c,"queueAnalysisForBackgroundSync",()=>a,"requestNotificationPermission",()=>e,"showAnalysisCompleteNotification",()=>s,"subscribeToPushNotifications",()=>i,"unsubscribeFromPushNotifications",()=>n])}]);

//# sourceMappingURL=698d52fcf730243a.js.map